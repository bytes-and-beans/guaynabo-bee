{#  Displays the current weeks events.  
    Events are pulled from the '' section.

    entry fields
        startTime
        endTime
        simpleUrl
        simpleContent
        eventTags
 #}

{# macro defining the days #}
{% macro day(startOfDay, isToday) %}
    {% set endOfDay =  startOfDay | date_modify('+1 day') | date_modify('-1 second') %}
    {% set dayQuery = craft.entries()
        .section('eventsCalendar')
        .startTime("<= #{ endOfDay | atom }") 
        .endTime(">= #{ startOfDay | atom }")
        .cache()
    %}
    {# day container #}
    <div class="flex">
        {# day/date box #}
        <div class="flex-grow-0 w-[4.5rem] {{isToday ? 'text-guaynabo-blue' :''}}">
            <h3 class="text-center text-3xl">{{ startOfDay | date('d') }}</h3>
            <div class="text-center">{{startOfDay | date('l') | lower }}</div>
        </div>
        {# events listing #}
        <div class="">
            {% if dayQuery.exists %}
                <div class="">
                    {{dayQuery.count()}} eventos este diá.
                </div>
            {% else %}
                <div class="">No hay eventos este diá</div>
            {% endif %}
        </div>
    </div>
{% endmacro %}

{% set today = now | date_modify('today') %}

{# this week's calendar #}
<div class="w-full">
    <h2 class="text-center">Próximamente</h2>
    <div class="w-full">
        {# The individual days #}
        {% for number in 0..6 %}
            {% set thisDay =  today | date_modify("+#{number} day") %}
            {{ _self.day(thisDay, loop.first) }}
        {% endfor %}
</div>
</div>